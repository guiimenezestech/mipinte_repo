<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MiPinte — Teste de Instalação</title>
  <style>
    :root{--bg:#F9FAFB;--card:#fff;--text:#0F172A;--muted:#64748B;--primary:#4D96FF;--border:#E2E8F0;}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Noto Sans",sans-serif}
    .wrap{max-width:840px;margin:24px auto;padding:0 16px}
    h1{font-size:24px;margin:0 0 12px}
    p{color:var(--muted);margin:6px 0 16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;margin:12px 0}
    label{display:block;font-weight:600;margin-bottom:6px}
    input[type="text"}{width:100%;padding:12px;border-radius:12px;border:1px solid var(--border);font-size:14px}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    .btn{background:var(--primary);color:#fff;border:none;border-radius:999px;padding:10px 16px;font-weight:700;cursor:pointer;text-decoration:none;display:inline-block}
    .btn.secondary{background:#fff;color:var(--muted);border:1px solid var(--border)}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .examples{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .badge{font-size:12px;color:var(--muted)}
    .footer{margin-top:24px;font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>MiPinte — Teste de Instalação via Deep Link</h1>
    <p>Use <span class="mono">mipinte://install?url=&lt;ZIP_URL&gt;</span>. O app deriva o <em>id</em> do nome do arquivo antes de <span class="mono">.zip</span>.</p>

    <div class="card">
      <label for="zipUrl">URL do arquivo .zip</label>
      <input id="zipUrl" type="text" placeholder="https://raw.githubusercontent.com/guiimenezestech/mipinte_repo/main/packs/gato-fofinho.zip" />
      <div class="row">
        <a id="openLink" class="btn" href="#">Abrir no MiPinte</a>
        <button id="copyLink" class="btn secondary" type="button">Copiar deep link</button>
        <span id="status" class="badge"></span>
      </div>
      <p class="badge">Abra esta página no celular com o app instalado. Toque no botão para abrir o app.</p>
    </div>

    <div class="card">
      <strong>Exemplos</strong>
      <div class="examples" id="examples"></div>
    </div>

    <div class="footer">
      Cada .zip deve conter na raiz: <span class="mono">manifest.json</span>, <span class="mono">drawing.mipaint.json</span>, <span class="mono">drawing.svg</span>, <span class="mono">thumb.png</span>.
    </div>
  </div>

  <script>
    const $ = (q)=>document.querySelector(q);
    const zipInput = $('#zipUrl');
    const openLink = $('#openLink');
    const copyBtn  = $('#copyLink');
    const statusEl = $('#status');
    const examplesEl = $('#examples');

    // BASE do seu repositório
    const BASE = 'https://raw.githubusercontent.com/guiimenezestech/mipinte_repo/main/packs';
    const EXAMPLES = [
      { title:'Gato Fofinho',  zip: BASE + '/gato-fofinho.zip' },
      { title:'Gato Fofis',  zip: BASE + '/gato-fofis.zip' },
      { title:'Peixe Sorriso', zip: BASE + '/peixe-sorriso.zip' },
    ];

    function buildDeepLink(zipUrl){ return 'mipinte://install?url=' + encodeURIComponent(zipUrl.trim()); }

    function setLinkFromInput(){
      const val = zipInput.value.trim();
      if(!val){ openLink.removeAttribute('href'); return; }
      openLink.setAttribute('href', buildDeepLink(val));
    }

    zipInput.addEventListener('input', setLinkFromInput);
    setLinkFromInput();

    openLink.addEventListener('click', (e)=>{
      const href = openLink.getAttribute('href');
      if(!href){ e.preventDefault(); statusEl.textContent = 'Informe a URL do zip.'; return; }
      statusEl.textContent = '';
    });

    copyBtn.addEventListener('click', async ()=>{
      const val = zipInput.value.trim();
      if(!val){ statusEl.textContent = 'Informe a URL do zip.'; return; }
      const deep = buildDeepLink(val);
      try{ await navigator.clipboard.writeText(deep); statusEl.textContent = 'Deep link copiado!'; }
      catch{ statusEl.textContent = deep; }
    });

    function renderExamples(){
      examplesEl.innerHTML = '';
      EXAMPLES.forEach(ex => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center;gap:8px">
            <div>
              <div style="font-weight:700">${ex.title}</div>
              <div class="badge mono" style="word-break:break-all">${ex.zip}</div>
            </div>
            <a class="btn" href="${buildDeepLink(ex.zip)}">Instalar</a>
          </div>
        `;
        examplesEl.appendChild(card);
      });
    }
    renderExamples();
  </script>
</body>
</html>
